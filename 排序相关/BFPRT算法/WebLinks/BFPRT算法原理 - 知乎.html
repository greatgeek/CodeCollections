<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600986 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5609"/>

<div><span>
  <div style="--en-clipped-content:fullPage">
<div><br/></div><div style="font-size: 16px; display:block; min-width: 100%; position: relative;"> <div><div style="font-family:-apple-system, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;color:rgb(26, 26, 26);-webkit-tap-highlight-color:rgba(26, 26, 26, 0);background:rgb(255, 255, 255);"><div><div><span style="padding-bottom:46px;"><div style="background:rgb(255, 255, 255);min-width:1000px;overflow:hidden;"><div style="width:100%;"><div><div style="visibility:hidden;position:relative;top:0px;right:0px;bottom:0px;left:0px;display:block;float:none;margin:0px;height:52px;"></div></div></div><div style="box-sizing:border-box;overflow:hidden;"><div style="overflow:hidden;width:690px;margin:0px auto;"><h1 style="font:inherit;font-weight:600;font-size:24px;line-height:1.22;overflow-wrap:break-word;margin:24px 0px;">BFPRT算法原理</h1><div style="display:flex;-webkit-box-align:center;align-items:center;"><div style="display:flex;-webkit-box-align:center;align-items:center;-webkit-box-flex:1;flex:1 1 0%;white-space:nowrap;overflow:hidden;"><span><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/acdreamers" style="color:inherit;text-decoration:none;" target="_blank"><img src="BFPRT算法原理 - 知乎_files/v2-9cabf20067528e2bcbe7bac1bb095936_l.jpg" type="image/jpeg" data-filename="v2-9cabf20067528e2bcbe7bac1bb095936_l.jpg" height="38" style="background:rgb(255, 255, 255);border-radius:50%;vertical-align:top;" width="38"/></a></div></div></span><div style="-webkit-box-flex:1;flex:1 1 0%;margin-left:14px;overflow:hidden;"><div style="display:flex;-webkit-box-align:center;align-items:center;font-size:15px;line-height:1.1;flex-shrink:0;"><span style="font-weight:600;color:rgb(68, 68, 68);"><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/acdreamers" style="color:inherit;text-decoration:none;" target="_blank">ACdreamer</a></div></div><a href="https://www.zhihu.com/question/48510028" style="text-decoration:none;box-sizing:border-box;margin:0px 0px 0px 0.3em;min-width:0px;display:inline-block;width:18px;height:18px;color:rgb(23, 81, 153);" target="_blank"><span style="display:inline-flex;-webkit-box-align:center;align-items:center;">​<img src="data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='18' height='18'%3e%3csvg viewBox='0 0 24 24' x='-3' y='-3' fill='%23FFFFFF' width='30' height='30'%3e%3cpath d='M3.56231227%2c13.8535307 C2.40051305%2c12.768677 2.41398885%2c11.0669203 3.59484487%2c9.99979213 L3.59222085%2c9.99654885 C4.26730143%2c9.45036719 4.79446755%2c8.21005186 4.7184197%2c7.34453784 L4.72305873%2c7.34412719 C4.66942824%2c5.75539997 5.8824188%2c4.56066914 7.47188965%2c4.64242381 L7.47229112%2c4.6386236 C8.33515314%2c4.72977993 9.58467253%2c4.22534048 10.1426329%2c3.55925173 L10.1462611%2c3.56228565 C11.2316055%2c2.40008701 12.9353108%2c2.41394456 14.0015072%2c3.59634088 L14.0047263%2c3.59374004 C14.5498229%2c4.26841874 15.7896857%2c4.79521622 16.6545744%2c4.71844347 L16.6549836%2c4.72304294 C18.245027%2c4.66894057 19.4396947%2c5.88213996 19.3575031%2c7.47241135 L19.3623099%2c7.47292747 C19.2704388%2c8.3358681 19.7742711%2c9.58421483 20.4407199%2c10.1424506 L20.437686%2c10.1460789 C21.5997217%2c11.2312209 21.5860695%2c12.9345218 20.4042441%2c14.0007396 L20.4072865%2c14.0045125 C19.7325967%2c14.5495925 19.2055209%2c15.7896954 19.2815865%2c16.6561959 L19.2770449%2c16.6565978 C19.3315454%2c18.2453037 18.1173775%2c19.4393568 16.5274188%2c19.3571512 L16.5269029%2c19.3619539 C15.6647098%2c19.270083 14.415408%2c19.7741709 13.8573671%2c20.4403558 L13.8537409%2c20.4373235 C12.76842%2c21.5995708 11.0650432%2c21.5864553 9.99899434%2c20.4039226 L9.99527367%2c20.406923 C9.45025436%2c19.7323399 8.21017638%2c19.2051872 7.34461983%2c19.2812352 L7.344304%2c19.2776405 C5.75448683%2c19.3312904 4.55977145%2c18.1170085 4.64254978%2c16.527117 L4.63769921%2c16.5265942 C4.72957031%2c15.6644394 4.22547659%2c14.4151814 3.55928015%2c13.8571569 L3.56231227%2c13.8535307 Z'%3e%3c/path%3e%3c/svg%3e%3cpath d='M2.63951518%2c13.3895441 C3.70763333%2c14.2842292 4.44777637%2c16.1226061 4.30075305%2c17.5023312 L4.32211542%2c17.3063047 C4.17509209%2c18.6910561 5.17786655%2c19.7063729 6.5613937%2c19.5844846 L6.364106%2c19.6008202 C7.75140298%2c19.4789319 9.57474349%2c20.2554985 10.4468305%2c21.3349009 L10.3224262%2c21.1803415 C11.1982831%2c22.2647703 12.6257916%2c22.2723098 13.5167278%2c21.2079863 L13.3898102%2c21.3600325 C14.2845162%2c20.2919393 16.1229361%2c19.5518136 17.5026934%2c19.6988334 L17.3054057%2c19.6774716 C18.6914461%2c19.8244915 19.7067866%2c18.8217404 19.5836389%2c17.4395022 L19.6012314%2c17.6367853 C19.4793403%2c16.2482641 20.255925%2c14.4249662 21.3353526%2c13.5528995 L21.1807897%2c13.677301 C22.2639871%2c12.8014646 22.2727834%2c11.3739894 21.2084351%2c10.483074 L21.3604848%2c10.6099886 C20.2923667%2c9.71530351 19.5522236%2c7.87818322 19.6992469%2c6.49720154 L19.6778846%2c6.69448464 C19.8249079%2c5.30847665 18.8221335%2c4.2944164 17.4386063%2c4.41630468 L17.635894%2c4.39871256 C16.248597%2c4.52185742 14.4252565%2c3.74529084 13.5531695%2c2.66588842 L13.6775738%2c2.81919121 C12.8017169%2c1.73601905 11.3742084%2c1.72722299 10.4832722%2c2.79154644 L10.6101898%2c2.63950024 C9.71548377%2c3.70759343 7.87706394%2c4.44771919 6.49730661%2c4.30195588 L6.69459432%2c4.32206116 C5.30855394%2c4.17504128 4.29447%2c5.17904888 4.41636114%2c6.56128713 L4.3987686%2c6.36400404 C4.52065973%2c7.75126861 3.74407501%2c9.57456653 2.66464737%2c10.4478898 L2.81921035%2c10.3222318 C1.73601288%2c11.1993248 1.72721662%2c12.6255433 2.79156494%2c13.5164587 L2.63951518%2c13.3895441 Z' fill='%230084FF'%3e%3c/path%3e%3csvg class='Zi Zi--Check' fill='%23fff' x='6' y='6' viewBox='0 0 24 24' width='12' height='12'%3e%3cpath d='M10.229 17.516c-.318.327-.75.484-1.199.484-.453 0-.884-.16-1.202-.488l-4.335-4.47a1.77 1.77 0 0 1 .007-2.459 1.663 1.663 0 0 1 2.397.01l3.137 3.246 9.072-9.329a1.662 1.662 0 0 1 2.397 0c.663.681.663 1.786 0 2.466L10.23 17.516z' fill-rule='evenodd'%3e%3c/path%3e%3c/svg%3e%3c/svg%3e"></img></span></a></span></div><div style="overflow:hidden;color:rgb(100, 100, 100);"><div style="display:flex;-webkit-box-align:center;align-items:center;margin-top:2px;font-size:14px;"><div style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:rgb(100, 100, 100);">淘宝（中国）软件有限公司 算法专家</div></div></div></div></div></div><div><span style="display:block;margin-top:14px;font-size:14px;color:rgb(133, 144, 166);"></span></div></div><div style="position:relative;width:690px;margin:0px auto;overflow:visible;"><div style="word-break:break-word;line-height:1.6;margin-top:20px;"><p style="margin:1.4em 0px;margin-top:0px;">通常我们需要在一大堆数中求前 <img src="BFPRT算法原理 - 知乎_files/equation" type="image/png" data-filename="equation" height="20" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="11"/> 大的数。比如在搜索引擎中求当天用户点击次数排名前10000的热词，在文本特征选择中求 <img src="BFPRT算法原理 - 知乎_files/equation [1]" type="image/png" data-filename="equation" height="22" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="74"/> 值按从大到小排名前 <img src="BFPRT算法原理 - 知乎_files/equation [2]" type="image/png" data-filename="equation" height="20" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="11"/> 等问题，都涉及到一个核心问题，即<b style="font-weight:600;">TOP-K问题</b>。</p><p style="margin:-0.8em 0px;"><br/></p><p style="margin:1.4em 0px;">求TOP-K问题最简单的方式为快速排序后取前K大的即可。但是这样做有两个问题</p><p style="margin:1.4em 0px;">1. 快速排序的平均复杂度为 <img src="BFPRT算法原理 - 知乎_files/equation [3]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="104"/> ，但最坏时间复杂度为 <img src="BFPRT算法原理 - 知乎_files/equation [4]" type="image/png" data-filename="equation" height="28" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="54"/> 。</p><p style="margin:1.4em 0px;">2. 我们只需要前 <img src="BFPRT算法原理 - 知乎_files/equation [5]" type="image/png" data-filename="equation" height="20" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="11"/> 大的，而对其余不需要的数也进行了排序，浪费了大量排序时间。</p><p style="margin:1.4em 0px;">而堆排序也是一个较好的方法，维护一个大小为 <img src="BFPRT算法原理 - 知乎_files/equation [6]" type="image/png" data-filename="equation" height="20" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="11"/> 的堆，时间复杂度为 <img src="BFPRT算法原理 - 知乎_files/equation [7]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="102"/> 。</p><p style="margin:-0.8em 0px;"><br/></p><p style="margin:1.4em 0px;">这里介绍一个比较好的算法，叫做<b style="font-weight:600;">BFPTR算法</b>，又称为<b style="font-weight:600;">中位数的中位数算法</b>，它的最坏时间复杂度为 <img src="BFPRT算法原理 - 知乎_files/equation [8]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="45"/> ，它是由<b style="font-weight:600;">Blum、Floyd、Pratt、Rivest、Tarjan</b>提出。该算法的思想是修改快速选择算法的主元选取方法，提高算法在最坏情况下的时间复杂度。</p><p style="margin:-0.8em 0px;"><br/></p><p style="margin:1.4em 0px;"><b style="font-weight:600;">一. 快速排序原理</b></p><p style="margin:1.4em 0px;">先来看看快速排序是如何进行的，一趟快速排序的过程如下</p><ol style="padding:0px;margin:1.4em 0px;display:table;"><li style="list-style-type:none;display:table-row;list-style:none;"><span style="list-style-type:none;list-style:none;display:table-cell;text-align:right;white-space:pre;">1. </span>先从序列中选取一个数作为基准数</li><li style="list-style-type:none;display:table-row;list-style:none;"><span style="list-style-type:none;list-style:none;display:table-cell;text-align:right;white-space:pre;">2. </span>将比这个数大的数全部放到它的右边，把小于或者等于它的数全部放到它的左边</li></ol><p style="margin:1.4em 0px;">一趟快速排序也叫做<b style="font-weight:600;">Partion</b>，即将序列划分为两部分，一部分比基准数小，另一部分比基准数大，然后再进行分治过程，每一次<b style="font-weight:600;">Partion</b>不一定都能保证划分得很均匀，所以最坏情况下的时间复杂度不能保证总是为 <img src="BFPRT算法原理 - 知乎_files/equation [9]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="104"/> 。对于<b style="font-weight:600;">Partion</b>过程，通常有两种方法</p><p style="margin:1.4em 0px;"><b style="font-weight:600;">1. 两个指针从首尾向中间扫描（双向扫描）</b></p><p style="margin:1.4em 0px;">这种方法可以用<b style="font-weight:600;">挖坑填数</b>来形容，比如</p><div style="margin:1.4em 0px;"><img src="BFPRT算法原理 - 知乎_files/v2-740c20889c11e2848ed31e03c4da0276_r.jpg" type="image/jpeg" data-filename="v2-740c20889c11e2848ed31e03c4da0276_r.jpg" height="133" style="margin:0px 46.5px; display:block; max-width:100%; cursor:zoom-in; background-color:rgba(0, 0, 0, 0); animation:0.5s ease-in 0s 1 normal none running fxRichTextFadeIn;" width="597"/></div><p style="margin:1.4em 0px;">初始化：i = 0; j = 9; pivot = a[0];</p><p style="margin:1.4em 0px;">现在a[0]保存到了变量pivot中了，相当于在数组a[0]处挖了个坑，那么可以将其它的数填到这里来。从j开始向前找一个小于或者等于pivot的数，即将a[8]填入a[0]，但a[8]又形成了一个新坑，再从i开始向后找一个大于pivot的数，即a[3]填入a[8]，那么a[3]又形成了一个新坑......</p><p style="margin:1.4em 0px;">就这样，直到i==j才停止，最终得到结果如下</p><div style="margin:1.4em 0px;"><img src="BFPRT算法原理 - 知乎_files/v2-5867b2c5d8c5efcad15bb0397f068a49_r.jpg" type="image/jpeg" data-filename="v2-5867b2c5d8c5efcad15bb0397f068a49_r.jpg" height="148" style="margin:0px 49px; display:block; max-width:100%; cursor:zoom-in; background-color:rgba(0, 0, 0, 0); animation:0.5s ease-in 0s 1 normal none running fxRichTextFadeIn;" width="592"/></div><p style="margin:1.4em 0px;">上述过程就是<b style="font-weight:600;">一趟快速排序</b>。</p><div style="margin:1em 0px;"><pre style="padding:0.88889em;font-size:0.9em;word-break:normal;overflow-wrap:normal;white-space:pre;overflow:auto;background:rgb(246, 246, 246);border-radius:4px;margin:0px;"><code style="font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;margin:0px;padding:0px;border-radius:0px;font-size:inherit;background-color:inherit;"><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;iostream&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;string.h&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;stdio.h&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;algorithm&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;time.h&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);"></span> 
<span style="font-weight:600;">using</span> <span style="font-weight:600;">namespace</span> <span>std</span><span>;</span>
<span style="font-weight:600;">const</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>N</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">10005</span><span>;</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span style="font-weight:600;color:rgb(241, 64, 60);">Partion</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[],</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>l</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>r</span><span>)</span>
<span>{</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span>l</span><span>;</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>j</span> <span style="font-weight:600;">=</span> <span>r</span><span>;</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>pivot</span> <span style="font-weight:600;">=</span> <span>a</span><span>[</span><span>l</span><span>];</span>
    <span style="font-weight:600;">while</span><span>(</span><span>i</span> <span style="font-weight:600;">&lt;</span> <span>j</span><span>)</span>
    <span>{</span>
        <span style="font-weight:600;">while</span><span>(</span><span>a</span><span>[</span><span>j</span><span>]</span> <span style="font-weight:600;">&gt;=</span> <span>pivot</span> <span style="font-weight:600;">&amp;&amp;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>j</span><span>)</span>
            <span>j</span><span style="font-weight:600;">--</span><span>;</span>
        <span>a</span><span>[</span><span>i</span><span>]</span> <span style="font-weight:600;">=</span> <span>a</span><span>[</span><span>j</span><span>];</span>
        <span style="font-weight:600;">while</span><span>(</span><span>a</span><span>[</span><span>i</span><span>]</span> <span style="font-weight:600;">&lt;=</span> <span>pivot</span> <span style="font-weight:600;">&amp;&amp;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>j</span><span>)</span>
            <span>i</span><span style="font-weight:600;">++</span><span>;</span>
        <span>a</span><span>[</span><span>j</span><span>]</span> <span style="font-weight:600;">=</span> <span>a</span><span>[</span><span>i</span><span>];</span>
    <span>}</span>
    <span>a</span><span>[</span><span>i</span><span>]</span> <span style="font-weight:600;">=</span> <span>pivot</span><span>;</span>
    <span style="font-weight:600;">return</span> <span>i</span><span>;</span>
<span>}</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">void</span> <span style="font-weight:600;color:rgb(241, 64, 60);">QuickSort</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[],</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>l</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>r</span><span>)</span>
<span>{</span>
    <span style="font-weight:600;">if</span><span>(</span><span>l</span> <span style="font-weight:600;">&lt;</span> <span>r</span><span>)</span>
    <span>{</span>
        <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>k</span> <span style="font-weight:600;">=</span> <span>Partion</span><span>(</span><span>a</span><span>,</span> <span>l</span><span>,</span> <span>r</span><span>);</span>
        <span>QuickSort</span><span>(</span><span>a</span><span>,</span> <span>l</span><span>,</span> <span>k</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>);</span>
        <span>QuickSort</span><span>(</span><span>a</span><span>,</span> <span>k</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">1</span><span>,</span> <span>r</span><span>);</span>
    <span>}</span>
<span>}</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[</span><span>N</span><span>];</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span style="font-weight:600;color:rgb(241, 64, 60);">main</span><span>()</span>
<span>{</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>n</span><span>;</span>
    <span style="font-weight:600;">while</span><span>(</span><span>cin</span> <span style="font-weight:600;">&gt;&gt;</span> <span>n</span><span>)</span>
    <span>{</span>
        <span style="font-weight:600;">for</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>n</span><span>;</span> <span>i</span><span style="font-weight:600;">++</span><span>)</span>
            <span>cin</span> <span style="font-weight:600;">&gt;&gt;</span> <span>a</span><span>[</span><span>i</span><span>];</span>
        <span>QuickSort</span><span>(</span><span>a</span><span>,</span> <span style="color:rgb(0, 132, 255);">0</span><span>,</span> <span>n</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>);</span>
        <span style="font-weight:600;">for</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>n</span><span>;</span> <span>i</span><span style="font-weight:600;">++</span><span>)</span>
            <span>cout</span> <span style="font-weight:600;">&lt;&lt;</span> <span>a</span><span>[</span><span>i</span><span>]</span> <span style="font-weight:600;">&lt;&lt;</span> <span style="color:rgb(241, 64, 60);">&quot; &quot;</span><span>;</span>
        <span>cout</span> <span style="font-weight:600;">&lt;&lt;</span> <span>endl</span><span>;</span>
    <span>}</span>
    <span style="font-weight:600;">return</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span>
<span>}</span>
</code></pre></div><p style="margin:1.4em 0px;"><b style="font-weight:600;">2. 两个指针一前一后逐步向前扫描（单向扫描）</b></p><div style="margin:1em 0px;"><pre style="padding:0.88889em;font-size:0.9em;word-break:normal;overflow-wrap:normal;white-space:pre;overflow:auto;background:rgb(246, 246, 246);border-radius:4px;margin:0px;"><code style="font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;margin:0px;padding:0px;border-radius:0px;font-size:inherit;background-color:inherit;"><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;iostream&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;string.h&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;stdio.h&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);"></span> 
<span style="font-weight:600;">using</span> <span style="font-weight:600;">namespace</span> <span>std</span><span>;</span>
<span style="font-weight:600;">const</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>N</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">10005</span><span>;</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span style="font-weight:600;color:rgb(241, 64, 60);">Partion</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[],</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>l</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>r</span><span>)</span>
<span>{</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span>l</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>;</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>pivot</span> <span style="font-weight:600;">=</span> <span>a</span><span>[</span><span>r</span><span>];</span>
    <span style="font-weight:600;">for</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>j</span> <span style="font-weight:600;">=</span> <span>l</span><span>;</span> <span>j</span> <span style="font-weight:600;">&lt;</span> <span>r</span><span>;</span> <span>j</span><span style="font-weight:600;">++</span><span>)</span>
    <span>{</span>
        <span style="font-weight:600;">if</span><span>(</span><span>a</span><span>[</span><span>j</span><span>]</span> <span style="font-weight:600;">&lt;=</span> <span>pivot</span><span>)</span>
        <span>{</span>
            <span>i</span><span style="font-weight:600;">++</span><span>;</span>
            <span>swap</span><span>(</span><span>a</span><span>[</span><span>i</span><span>],</span> <span>a</span><span>[</span><span>j</span><span>]);</span>
        <span>}</span>
    <span>}</span>
    <span>swap</span><span>(</span><span>a</span><span>[</span><span>i</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">1</span><span>],</span> <span>a</span><span>[</span><span>r</span><span>]);</span>
    <span style="font-weight:600;">return</span> <span>i</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">1</span><span>;</span>
<span>}</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">void</span> <span style="font-weight:600;color:rgb(241, 64, 60);">QuickSort</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[],</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>l</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>r</span><span>)</span>
<span>{</span>
    <span style="font-weight:600;">if</span><span>(</span><span>l</span> <span style="font-weight:600;">&lt;</span> <span>r</span><span>)</span>
    <span>{</span>
        <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>k</span> <span style="font-weight:600;">=</span> <span>Partion</span><span>(</span><span>a</span><span>,</span> <span>l</span><span>,</span> <span>r</span><span>);</span>
        <span>QuickSort</span><span>(</span><span>a</span><span>,</span> <span>l</span><span>,</span> <span>k</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>);</span>
        <span>QuickSort</span><span>(</span><span>a</span><span>,</span> <span>k</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">1</span><span>,</span> <span>r</span><span>);</span>
    <span>}</span>
<span>}</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[</span><span>N</span><span>];</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span style="font-weight:600;color:rgb(241, 64, 60);">main</span><span>()</span>
<span>{</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>n</span><span>;</span>
    <span style="font-weight:600;">while</span><span>(</span><span>cin</span> <span style="font-weight:600;">&gt;&gt;</span> <span>n</span><span>)</span>
    <span>{</span>
        <span style="font-weight:600;">for</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>n</span><span>;</span> <span>i</span><span style="font-weight:600;">++</span><span>)</span>
            <span>cin</span> <span style="font-weight:600;">&gt;&gt;</span> <span>a</span><span>[</span><span>i</span><span>];</span>
        <span>QuickSort</span><span>(</span><span>a</span><span>,</span> <span style="color:rgb(0, 132, 255);">0</span><span>,</span> <span>n</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>);</span>
        <span style="font-weight:600;">for</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>n</span><span>;</span> <span>i</span><span style="font-weight:600;">++</span><span>)</span>
            <span>cout</span> <span style="font-weight:600;">&lt;&lt;</span> <span>a</span><span>[</span><span>i</span><span>]</span> <span style="font-weight:600;">&lt;&lt;</span> <span style="color:rgb(241, 64, 60);">&quot; &quot;</span><span>;</span>
        <span>cout</span> <span style="font-weight:600;">&lt;&lt;</span> <span>endl</span><span>;</span>
    <span>}</span>
    <span style="font-weight:600;">return</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span>
<span>}</span>
</code></pre></div><p style="margin:1.4em 0px;">基于双向扫描的快速排序要比基于单向扫描的快速排序算法快很多。</p><p style="margin:-0.8em 0px;"><br/></p><p style="margin:1.4em 0px;"><b style="font-weight:600;">二. BFPRT算法原理</b></p><p style="margin:1.4em 0px;">在BFPTR算法中，仅仅是改变了快速排序<b style="font-weight:600;">Partion</b>中的<b style="font-weight:600;">pivot</b>值的选取，在快速排序中，我们始终选择第一个元素或者最后一个元素作为<b style="font-weight:600;">pivot</b>，而在BFPTR算法中，每次选择五分中位数的中位数作为<b style="font-weight:600;">pivot</b>，这样做的目的就是使得划分比较合理，从而避免了最坏情况的发生。算法步骤如下</p><blockquote style="margin:1.4em 0px;padding-left:1em;color:rgb(100, 100, 100);border-left:3px solid rgb(211, 211, 211);"><b style="font-weight:600;">1. 将 <img src="BFPRT算法原理 - 知乎_files/equation [10]" type="image/png" data-filename="equation" height="16" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="13"/> 个元素划为 <img src="BFPRT算法原理 - 知乎_files/equation [11]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="52"/> 组，每组5个，至多只有一组由 <img src="BFPRT算法原理 - 知乎_files/equation [12]" type="image/png" data-filename="equation" height="20" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="74"/> 个元素组成。</b> <br/><b style="font-weight:600;">2. 寻找这 <img src="BFPRT算法原理 - 知乎_files/equation [13]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="52"/> 个组中每一个组的中位数，这个过程可以用插入排序。</b> <br/><b style="font-weight:600;">3. 对步骤2中的 <img src="BFPRT算法原理 - 知乎_files/equation [14]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="52"/> 个中位数，重复步骤1和步骤2，递归下去，直到剩下一个数字。</b><br/><b style="font-weight:600;">4. 最终剩下的数字即为pivot，把大于它的数全放左边，小于等于它的数全放右边。</b> <br/><b style="font-weight:600;">5. 判断pivot的位置与k的大小，有选择的对左边或右边递归。</b></blockquote><p style="margin:1.4em 0px;">求第 <img src="BFPRT算法原理 - 知乎_files/equation [15]" type="image/png" data-filename="equation" height="20" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="11"/> 大就是求第 <img src="BFPRT算法原理 - 知乎_files/equation [16]" type="image/png" data-filename="equation" height="21" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="85"/> 小，这两者等价。</p><div style="margin:1em 0px;"><pre style="padding:0.88889em;font-size:0.9em;word-break:normal;overflow-wrap:normal;white-space:pre;overflow:auto;background:rgb(246, 246, 246);border-radius:4px;margin:0px;"><code style="font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;margin:0px;padding:0px;border-radius:0px;font-size:inherit;background-color:inherit;"><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;iostream&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;string.h&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;stdio.h&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;time.h&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);">#include</span> <span>&lt;algorithm&gt;</span><span style="font-weight:600;color:rgb(153, 153, 153);">
</span><span style="font-weight:600;color:rgb(153, 153, 153);"></span> 
<span style="font-weight:600;">using</span> <span style="font-weight:600;">namespace</span> <span>std</span><span>;</span>
<span style="font-weight:600;">const</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>N</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">10005</span><span>;</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[</span><span>N</span><span>];</span>
 
<span style="font-style:italic;color:rgb(153, 153, 153);">//插入排序
</span><span style="font-style:italic;color:rgb(153, 153, 153);"></span><span style="font-weight:600;color:rgb(23, 81, 153);">void</span> <span style="font-weight:600;color:rgb(241, 64, 60);">InsertSort</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[],</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>l</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>r</span><span>)</span>
<span>{</span>
    <span style="font-weight:600;">for</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span>l</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">1</span><span>;</span> <span>i</span> <span style="font-weight:600;">&lt;=</span> <span>r</span><span>;</span> <span>i</span><span style="font-weight:600;">++</span><span>)</span>
    <span>{</span>
        <span style="font-weight:600;">if</span><span>(</span><span>a</span><span>[</span><span>i</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>]</span> <span style="font-weight:600;">&gt;</span> <span>a</span><span>[</span><span>i</span><span>])</span>
        <span>{</span>
            <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>t</span> <span style="font-weight:600;">=</span> <span>a</span><span>[</span><span>i</span><span>];</span>
            <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>j</span> <span style="font-weight:600;">=</span> <span>i</span><span>;</span>
            <span style="font-weight:600;">while</span><span>(</span><span>j</span> <span style="font-weight:600;">&gt;</span> <span>l</span> <span style="font-weight:600;">&amp;&amp;</span> <span>a</span><span>[</span><span>j</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>]</span> <span style="font-weight:600;">&gt;</span> <span>t</span><span>)</span>
            <span>{</span>
                <span>a</span><span>[</span><span>j</span><span>]</span> <span style="font-weight:600;">=</span> <span>a</span><span>[</span><span>j</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>];</span>
                <span>j</span><span style="font-weight:600;">--</span><span>;</span>
            <span>}</span>
            <span>a</span><span>[</span><span>j</span><span>]</span> <span style="font-weight:600;">=</span> <span>t</span><span>;</span>
        <span>}</span>
    <span>}</span>
<span>}</span>
 
<span style="font-style:italic;color:rgb(153, 153, 153);">//寻找中位数的中位数
</span><span style="font-style:italic;color:rgb(153, 153, 153);"></span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span style="font-weight:600;color:rgb(241, 64, 60);">FindMid</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[],</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>l</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>r</span><span>)</span>
<span>{</span>
    <span style="font-weight:600;">if</span><span>(</span><span>l</span> <span style="font-weight:600;">==</span> <span>r</span><span>)</span> <span style="font-weight:600;">return</span> <span>l</span><span>;</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>n</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span>
    <span style="font-weight:600;">for</span><span>(</span><span>i</span> <span style="font-weight:600;">=</span> <span>l</span><span>;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>r</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">5</span><span>;</span> <span>i</span> <span style="font-weight:600;">+=</span> <span style="color:rgb(0, 132, 255);">5</span><span>)</span>
    <span>{</span>
        <span>InsertSort</span><span>(</span><span>a</span><span>,</span> <span>i</span><span>,</span> <span>i</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">4</span><span>);</span>
        <span>n</span> <span style="font-weight:600;">=</span> <span>i</span> <span style="font-weight:600;">-</span> <span>l</span><span>;</span>
        <span>swap</span><span>(</span><span>a</span><span>[</span><span>l</span> <span style="font-weight:600;">+</span> <span>n</span> <span style="font-weight:600;">/</span> <span style="color:rgb(0, 132, 255);">5</span><span>],</span> <span>a</span><span>[</span><span>i</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">2</span><span>]);</span>
    <span>}</span>
 
    <span style="font-style:italic;color:rgb(153, 153, 153);">//处理剩余元素
</span><span style="font-style:italic;color:rgb(153, 153, 153);"></span>    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>num</span> <span style="font-weight:600;">=</span> <span>r</span> <span style="font-weight:600;">-</span> <span>i</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">1</span><span>;</span>
    <span style="font-weight:600;">if</span><span>(</span><span>num</span> <span style="font-weight:600;">&gt;</span> <span style="color:rgb(0, 132, 255);">0</span><span>)</span>
    <span>{</span>
        <span>InsertSort</span><span>(</span><span>a</span><span>,</span> <span>i</span><span>,</span> <span>i</span> <span style="font-weight:600;">+</span> <span>num</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>);</span>
        <span>n</span> <span style="font-weight:600;">=</span> <span>i</span> <span style="font-weight:600;">-</span> <span>l</span><span>;</span>
        <span>swap</span><span>(</span><span>a</span><span>[</span><span>l</span> <span style="font-weight:600;">+</span> <span>n</span> <span style="font-weight:600;">/</span> <span style="color:rgb(0, 132, 255);">5</span><span>],</span> <span>a</span><span>[</span><span>i</span> <span style="font-weight:600;">+</span> <span>num</span> <span style="font-weight:600;">/</span> <span style="color:rgb(0, 132, 255);">2</span><span>]);</span>
    <span>}</span>
    <span>n</span> <span style="font-weight:600;">/=</span> <span style="color:rgb(0, 132, 255);">5</span><span>;</span>
    <span style="font-weight:600;">if</span><span>(</span><span>n</span> <span style="font-weight:600;">==</span> <span>l</span><span>)</span> <span style="font-weight:600;">return</span> <span>l</span><span>;</span>
    <span style="font-weight:600;">return</span> <span>FindMid</span><span>(</span><span>a</span><span>,</span> <span>l</span><span>,</span> <span>l</span> <span style="font-weight:600;">+</span> <span>n</span><span>);</span>
<span>}</span>
 
<span style="font-style:italic;color:rgb(153, 153, 153);">//进行划分过程
</span><span style="font-style:italic;color:rgb(153, 153, 153);"></span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span style="font-weight:600;color:rgb(241, 64, 60);">Partion</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[],</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>l</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>r</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>p</span><span>)</span>
<span>{</span>
    <span>swap</span><span>(</span><span>a</span><span>[</span><span>p</span><span>],</span> <span>a</span><span>[</span><span>l</span><span>]);</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span>l</span><span>;</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>j</span> <span style="font-weight:600;">=</span> <span>r</span><span>;</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>pivot</span> <span style="font-weight:600;">=</span> <span>a</span><span>[</span><span>l</span><span>];</span>
    <span style="font-weight:600;">while</span><span>(</span><span>i</span> <span style="font-weight:600;">&lt;</span> <span>j</span><span>)</span>
    <span>{</span>
        <span style="font-weight:600;">while</span><span>(</span><span>a</span><span>[</span><span>j</span><span>]</span> <span style="font-weight:600;">&gt;=</span> <span>pivot</span> <span style="font-weight:600;">&amp;&amp;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>j</span><span>)</span>
            <span>j</span><span style="font-weight:600;">--</span><span>;</span>
        <span>a</span><span>[</span><span>i</span><span>]</span> <span style="font-weight:600;">=</span> <span>a</span><span>[</span><span>j</span><span>];</span>
        <span style="font-weight:600;">while</span><span>(</span><span>a</span><span>[</span><span>i</span><span>]</span> <span style="font-weight:600;">&lt;=</span> <span>pivot</span> <span style="font-weight:600;">&amp;&amp;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>j</span><span>)</span>
            <span>i</span><span style="font-weight:600;">++</span><span>;</span>
        <span>a</span><span>[</span><span>j</span><span>]</span> <span style="font-weight:600;">=</span> <span>a</span><span>[</span><span>i</span><span>];</span>
    <span>}</span>
    <span>a</span><span>[</span><span>i</span><span>]</span> <span style="font-weight:600;">=</span> <span>pivot</span><span>;</span>
    <span style="font-weight:600;">return</span> <span>i</span><span>;</span>
<span>}</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span style="font-weight:600;color:rgb(241, 64, 60);">BFPRT</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>a</span><span>[],</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>l</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>r</span><span>,</span> <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>k</span><span>)</span>
<span>{</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>p</span> <span style="font-weight:600;">=</span> <span>FindMid</span><span>(</span><span>a</span><span>,</span> <span>l</span><span>,</span> <span>r</span><span>);</span>    <span style="font-style:italic;color:rgb(153, 153, 153);">//寻找中位数的中位数
</span><span style="font-style:italic;color:rgb(153, 153, 153);"></span>    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span>Partion</span><span>(</span><span>a</span><span>,</span> <span>l</span><span>,</span> <span>r</span><span>,</span> <span>p</span><span>);</span>
 
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>m</span> <span style="font-weight:600;">=</span> <span>i</span> <span style="font-weight:600;">-</span> <span>l</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">1</span><span>;</span>
    <span style="font-weight:600;">if</span><span>(</span><span>m</span> <span style="font-weight:600;">==</span> <span>k</span><span>)</span> <span style="font-weight:600;">return</span> <span>a</span><span>[</span><span>i</span><span>];</span>
    <span style="font-weight:600;">if</span><span>(</span><span>m</span> <span style="font-weight:600;">&gt;</span> <span>k</span><span>)</span>  <span style="font-weight:600;">return</span> <span>BFPRT</span><span>(</span><span>a</span><span>,</span> <span>l</span><span>,</span> <span>i</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>,</span> <span>k</span><span>);</span>
    <span style="font-weight:600;">return</span> <span>BFPRT</span><span>(</span><span>a</span><span>,</span> <span>i</span> <span style="font-weight:600;">+</span> <span style="color:rgb(0, 132, 255);">1</span><span>,</span> <span>r</span><span>,</span> <span>k</span> <span style="font-weight:600;">-</span> <span>m</span><span>);</span>
<span>}</span>
 
<span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span style="font-weight:600;color:rgb(241, 64, 60);">main</span><span>()</span>
<span>{</span>
    <span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>n</span><span>,</span> <span>k</span><span>;</span>
    <span>scanf</span><span>(</span><span style="color:rgb(241, 64, 60);">&quot;%d&quot;</span><span>,</span> <span style="font-weight:600;">&amp;</span><span>n</span><span>);</span>
    <span style="font-weight:600;">for</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>n</span><span>;</span> <span>i</span><span style="font-weight:600;">++</span><span>)</span>
        <span>scanf</span><span>(</span><span style="color:rgb(241, 64, 60);">&quot;%d&quot;</span><span>,</span> <span style="font-weight:600;">&amp;</span><span>a</span><span>[</span><span>i</span><span>]);</span>
    <span>scanf</span><span>(</span><span style="color:rgb(241, 64, 60);">&quot;%d&quot;</span><span>,</span> <span style="font-weight:600;">&amp;</span><span>k</span><span>);</span>
    <span>printf</span><span>(</span><span style="color:rgb(241, 64, 60);">&quot;The %d th number is : %d</span><span style="color:rgb(241, 64, 60);">\n</span><span style="color:rgb(241, 64, 60);">&quot;</span><span>,</span> <span>k</span><span>,</span> <span>BFPRT</span><span>(</span><span>a</span><span>,</span> <span style="color:rgb(0, 132, 255);">0</span><span>,</span> <span>n</span> <span style="font-weight:600;">-</span> <span style="color:rgb(0, 132, 255);">1</span><span>,</span> <span>k</span><span>));</span>
    <span style="font-weight:600;">for</span><span>(</span><span style="font-weight:600;color:rgb(23, 81, 153);">int</span> <span>i</span> <span style="font-weight:600;">=</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span> <span>i</span> <span style="font-weight:600;">&lt;</span> <span>n</span><span>;</span> <span>i</span><span style="font-weight:600;">++</span><span>)</span>
        <span>printf</span><span>(</span><span style="color:rgb(241, 64, 60);">&quot;%d &quot;</span><span>,</span> <span>a</span><span>[</span><span>i</span><span>]);</span>
    <span>puts</span><span>(</span><span style="color:rgb(241, 64, 60);">&quot;&quot;</span><span>);</span>
    <span style="font-weight:600;">return</span> <span style="color:rgb(0, 132, 255);">0</span><span>;</span>
<span>}</span>
 
<span style="font-style:italic;color:rgb(153, 153, 153);">/**
</span><span style="font-style:italic;color:rgb(153, 153, 153);">10
</span><span style="font-style:italic;color:rgb(153, 153, 153);">72 6 57 88 60 42 83 73 48 85
</span><span style="font-style:italic;color:rgb(153, 153, 153);">5
</span><span style="font-style:italic;color:rgb(153, 153, 153);">*/</span>
</code></pre></div><p style="margin:1.4em 0px;"><b style="font-weight:600;">三. 时间复杂度分析</b></p><p style="margin:1.4em 0px;">BFPRT算法的最坏时间复杂度为 <img src="BFPRT算法原理 - 知乎_files/equation [17]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="45"/> 。设 <img src="BFPRT算法原理 - 知乎_files/equation [18]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="44"/> 为时间复杂度，那么很容易有如下公式</p><p style="margin:1.4em 0px;"><img src="BFPRT算法原理 - 知乎_files/equation [19]" type="image/png" data-filename="equation" height="47" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="408"/> </p><ul style="padding:0px;margin:1.4em 0px;display:table;"><li style="list-style-type:none;display:table-row;list-style:none;"><span style="list-style-type:none;list-style:none;display:table-cell;white-space:pre;">•  </span><img src="BFPRT算法原理 - 知乎_files/equation [20]" type="image/png" data-filename="equation" height="42" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="51"/> 来自FindMid()， <img src="BFPRT算法原理 - 知乎_files/equation [21]" type="image/png" data-filename="equation" height="16" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="13"/> 个元素，5个一组，共有 <img src="BFPRT算法原理 - 知乎_files/equation [22]" type="image/png" data-filename="equation" height="42" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="39"/> 个中位数。</li><li style="list-style-type:none;display:table-row;list-style:none;"><span style="list-style-type:none;list-style:none;display:table-cell;white-space:pre;">•  </span><img src="BFPRT算法原理 - 知乎_files/equation [23]" type="image/png" data-filename="equation" height="47" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="62"/> 来自BFPRT()，在 <img src="BFPRT算法原理 - 知乎_files/equation [24]" type="image/png" data-filename="equation" height="42" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="39"/> 个中位数中，主元pivot大于其中 <img src="BFPRT算法原理 - 知乎_files/equation [25]" type="image/png" data-filename="equation" height="46" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="109"/> 个中位数，而每个中位数在本来5个数的小组中又大于或等于其中的3个数，所以主元pivot至少大于所有数中的 <img src="BFPRT算法原理 - 知乎_files/equation [26]" type="image/png" data-filename="equation" height="46" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="112"/>个。即划分之后任意一边的长度至少为 <img src="BFPRT算法原理 - 知乎_files/equation [27]" type="image/png" data-filename="equation" height="46" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="28"/> ，在最坏情况下，每次选择都选到了 <img src="BFPRT算法原理 - 知乎_files/equation [28]" type="image/png" data-filename="equation" height="46" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="28"/> 的那一部分。</li><li style="list-style-type:none;display:table-row;list-style:none;"><span style="list-style-type:none;list-style:none;display:table-cell;white-space:pre;">•  </span><img src="BFPRT算法原理 - 知乎_files/equation [29]" type="image/png" data-filename="equation" height="15" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="37"/> 来自其它地方，例如插入排序等其它的额外操作。</li></ul><p style="margin:1.4em 0px;"><b style="font-weight:600;">证明：</b>设 <img src="BFPRT算法原理 - 知乎_files/equation [30]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="107"/> ，其中 <img src="BFPRT算法原理 - 知乎_files/equation [31]" type="image/png" data-filename="equation" height="19" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="8"/> 可能是一个常数，也可能是关于 <img src="BFPRT算法原理 - 知乎_files/equation [32]" type="image/png" data-filename="equation" height="16" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="13"/> 的函数。带入上式</p><p style="margin:1.4em 0px;"><img src="BFPRT算法原理 - 知乎_files/equation [33]" type="image/png" data-filename="equation" height="47" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="502"/> </p><p style="margin:1.4em 0px;">      其中 <img src="BFPRT算法原理 - 知乎_files/equation [34]" type="image/png" data-filename="equation" height="15" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="9"/> 是常数，所以 <img src="BFPRT算法原理 - 知乎_files/equation [35]" type="image/png" data-filename="equation" height="19" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="8"/> 也是常数，即 <img src="BFPRT算法原理 - 知乎_files/equation [36]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="129"/> ，所以 <img src="BFPRT算法原理 - 知乎_files/equation [37]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="116"/> 。</p><p style="margin:-0.8em 0px;"><br/></p><p style="margin:1.4em 0px;"><b style="font-weight:600;">四. 为什么是5？</b></p><p style="margin:1.4em 0px;">在BFPRT算法中，为什么是选5个作为分组？</p><p style="margin:1.4em 0px;">首先，偶数排除，因为对于奇数来说，中位数更容易计算。</p><p style="margin:1.4em 0px;">如果选用3，有 <img src="BFPRT算法原理 - 知乎_files/equation [38]" type="image/png" data-filename="equation" height="26" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="299"/> ，其操作元素个数还是 <img src="BFPRT算法原理 - 知乎_files/equation [39]" type="image/png" data-filename="equation" height="16" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="13"/> 。</p><p style="margin:1.4em 0px;margin-bottom:0px;">如果选取7，9或者更大，在插入排序时耗时增加，常数 <img src="BFPRT算法原理 - 知乎_files/equation [40]" type="image/png" data-filename="equation" height="15" style="max-width:100%;vertical-align:middle;margin:0px 3px;display:inline-block;" width="9"/> 会很大，有些得不偿失。</p></div></div><div style="font-size:14px;color:rgb(133, 144, 166);padding:16px 0px;overflow:hidden;width:690px;margin:0px auto;">编辑于 2019-01-02</div><div style="text-align:center;font-size:14px;color:grey;overflow:hidden;width:690px;margin:0px auto;"><div><div style="margin-top:60px;line-height:18px;font-size:15px;">「真诚赞赏，手留余香」</div></div><div style="margin-top:20px;">还没有人赞赏，快来当第一个赞赏的人吧！</div></div><div style="overflow:hidden;width:690px;margin:0px auto;display:flex;"><div style="display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-flow:row wrap;-webkit-box-align:center;align-items:center;margin-bottom:-10px;padding:16px 0px;"><div style="position:relative;display:inline-block;padding:0px 12px;color:rgb(0, 132, 255);vertical-align:top;border-radius:100px;background:rgba(0, 132, 255, 0.1);overflow:hidden;margin-bottom:10px;height:33px;font-size:13px;line-height:33px;margin-right:5px;"><span><a href="https://www.zhihu.com/topic/19644323" style="color:inherit;text-decoration:none;" target="_blank"><div style="position:relative;display:inline-block;"><div>快速排序</div></div></a></span></div><div style="position:relative;display:inline-block;padding:0px 12px;color:rgb(0, 132, 255);border-radius:100px;background:rgba(0, 132, 255, 0.1);vertical-align:middle;overflow:hidden;margin-bottom:10px;height:33px;font-size:13px;line-height:33px;margin-right:5px;"><span><a href="https://www.zhihu.com/topic/19625716" style="color:inherit;text-decoration:none;" target="_blank"><div style="position:relative;display:inline-block;"><div>算法与数据结构</div></div></a></span></div><div style="position:relative;display:inline-block;padding:0px 12px;color:rgb(0, 132, 255);border-radius:100px;background:rgba(0, 132, 255, 0.1);vertical-align:middle;overflow:hidden;margin-bottom:10px;height:33px;font-size:13px;line-height:33px;"><span><a href="https://www.zhihu.com/topic/19622354" style="color:inherit;text-decoration:none;" target="_blank"><div style="position:relative;display:inline-block;"><div>排序算法</div></div></a></span></div></div></div><div style="overflow:hidden;width:690px;margin:0px auto;"><div style="visibility:hidden;position:static;top:auto;right:auto;bottom:0px;left:0px;display:block;float:none;margin:0px 0px 10px;height:54px;"></div></div></div><div style="box-sizing:border-box;overflow:hidden;"><div style="overflow:hidden;width:690px;margin:0px auto;padding-top:30px;margin-bottom:-8px;"><h3 style="margin:0px;font:inherit;font-weight:600;line-height:1.375;font-size:16px;color:rgb(26, 26, 26);border-bottom:1px solid rgb(235, 235, 235);border-top-width:1px;border-right-width:1px;border-left-width:1px;border-top-color:rgb(235, 235, 235);border-right-color:rgb(235, 235, 235);border-left-color:rgb(235, 235, 235);padding-bottom:12px;margin-top:0px;">文章被以下专栏收录</h3><ul style="padding:0px;margin:0px;"><div style="margin:24px 0px;"><div style="display:flex;height:40px;"><div style="float:left;margin-right:16px;"><a href="https://zhuanlan.zhihu.com/c_144675210" style="color:inherit;text-decoration:none;"><div style="position:relative;display:inline-block;"><div><img src="BFPRT算法原理 - 知乎_files/v2-da286abf84021ccba61ada4bba1def85_l.jpg" type="image/jpeg" data-filename="v2-da286abf84021ccba61ada4bba1def85_l.jpg" height="40" style="background:rgb(255, 255, 255);border-radius:50%;" width="40"/></div></div></a></div><div style="-webkit-box-flex:1;flex:1 1 0%;overflow:hidden;margin-right:6px;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;"><h2 style="font:inherit;line-height:1.6;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin:0px;font-size:15px;font-weight:600;color:rgb(68, 68, 68);"><a href="https://zhuanlan.zhihu.com/c_144675210" style="color:inherit;text-decoration:none;"><div style="position:relative;display:inline-block;"><div>算法之美</div></div></a></h2></div><div style="align-self:center;"></div></div></div><div style="margin:24px 0px;"><div style="display:flex;height:40px;"><div style="float:left;margin-right:16px;"><a href="https://zhuanlan.zhihu.com/c_144943014" style="color:inherit;text-decoration:none;"><div style="position:relative;display:inline-block;"><div><img src="BFPRT算法原理 - 知乎_files/4b70deef7_l.jpg" type="image/jpeg" data-filename="4b70deef7_l.jpg" height="40" style="background:rgb(255, 255, 255);border-radius:50%;" width="40"/></div></div></a></div><div style="-webkit-box-flex:1;flex:1 1 0%;overflow:hidden;margin-right:6px;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;-webkit-box-pack:center;justify-content:center;"><h2 style="font:inherit;line-height:1.6;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin:0px;font-size:15px;font-weight:600;color:rgb(68, 68, 68);"><a href="https://zhuanlan.zhihu.com/c_144943014" style="color:inherit;text-decoration:none;"><div style="position:relative;display:inline-block;"><div>人工智能</div></div></a></h2></div><div style="align-self:center;"></div></div></div></ul></div><div style="background:rgb(246, 246, 246);position:relative;overflow:hidden;margin:24px auto;width:1423px;"><h3 style="font:inherit;font-weight:600;line-height:1.375;font-size:16px;color:rgb(26, 26, 26);border-bottom:1px solid rgb(235, 235, 235);border-top-width:1px;border-right-width:1px;border-left-width:1px;border-top-color:rgb(235, 235, 235);border-right-color:rgb(235, 235, 235);border-left-color:rgb(235, 235, 235);padding-bottom:12px;width:690px;margin:24px auto 4px;">推荐阅读</h3><ul style="padding:0px;display:flex;-webkit-box-pack:center;justify-content:center;margin:32px auto;"><a href="https://zhuanlan.zhihu.com/p/91164898" style="color:inherit;text-decoration:none;height:226px;width:245px;min-width:245px;border-radius:5px;box-shadow:rgba(26, 26, 26, 0.06) 0px 6px 14px 0px;background:rgb(255, 255, 255);margin-right:14px;position:relative;overflow:hidden;transition:transform 0.3s ease 0s, -webkit-transform 0.3s ease 0s;"><div><img src="BFPRT算法原理 - 知乎_files/v2-4344fa6b4d0da335ea837f1e58ec76b2_qhd.jpg" type="image/jpeg" data-filename="v2-4344fa6b4d0da335ea837f1e58ec76b2_qhd.jpg" height="123" style="height:123px;width:245px;object-fit:cover;border-top-left-radius:5px;border-top-right-radius:5px;" width="245"/><h1 style="font:inherit;font-weight:600;font-size:16px;min-width:225px;color:rgb(26, 26, 26);line-height:22px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin:12px;">谈算法与数据结构的学习</h1><div style="position:absolute;bottom:12px;left:12px;display:flex;-webkit-box-pack:justify;justify-content:space-between;width:100%;font-size:14px;color:rgb(133, 144, 166);line-height:20px;"><span>bange...</span><span style="margin-right:24px;">发表于算法与数据...</span></div></div></a><a href="https://zhuanlan.zhihu.com/p/93129029" style="color:inherit;text-decoration:none;height:226px;width:245px;min-width:245px;border-radius:5px;box-shadow:rgba(26, 26, 26, 0.06) 0px 6px 14px 0px;background:rgb(255, 255, 255);margin-right:14px;position:relative;overflow:hidden;transition:transform 0.3s ease 0s, -webkit-transform 0.3s ease 0s;"><div><h1 style="font:inherit;font-weight:600;font-size:16px;min-width:225px;color:rgb(26, 26, 26);line-height:22px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin:12px;">排序--快速排序</h1><p style="font-size:14px;color:rgb(26, 26, 26);line-height:20px;max-height:118px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-line-clamp:6;-webkit-box-orient:vertical;margin:8px 12px;">相信我们在没接触过排序知识之前，一定会觉得快速排序非常具有魅力，不因别的单纯快排这个名字就让人不明觉厉，但是了解一个算法不应该只知道code，了解思想，应用非常重要。我先问出我心中…</p><div style="position:absolute;bottom:12px;left:12px;display:flex;-webkit-box-pack:justify;justify-content:space-between;width:100%;font-size:14px;color:rgb(133, 144, 166);line-height:20px;"><span>猪猪侠</span><span style="margin-right:24px;"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/32117512" style="color:inherit;text-decoration:none;height:226px;width:245px;min-width:245px;border-radius:5px;box-shadow:rgba(26, 26, 26, 0.06) 0px 6px 14px 0px;background:rgb(255, 255, 255);margin-right:14px;position:relative;overflow:hidden;transition:transform 0.3s ease 0s, -webkit-transform 0.3s ease 0s;"><div><img src="BFPRT算法原理 - 知乎_files/v2-3ab24ba2d7c0a55b014927aa8b88fa5e_qhd.jpg" type="image/jpeg" data-filename="v2-3ab24ba2d7c0a55b014927aa8b88fa5e_qhd.jpg" height="123" style="height:123px;width:245px;object-fit:cover;border-top-left-radius:5px;border-top-right-radius:5px;" width="245"/><h1 style="font:inherit;font-weight:600;font-size:16px;min-width:225px;color:rgb(26, 26, 26);line-height:22px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin:12px;">数据结构笔记--排序(4)</h1><div style="position:absolute;bottom:12px;left:12px;display:flex;-webkit-box-pack:justify;justify-content:space-between;width:100%;font-size:14px;color:rgb(133, 144, 166);line-height:20px;"><span>yanqishi1</span><span style="margin-right:24px;"></span></div></div></a><a href="https://zhuanlan.zhihu.com/p/37466928" style="color:inherit;text-decoration:none;height:226px;width:245px;min-width:245px;border-radius:5px;box-shadow:rgba(26, 26, 26, 0.06) 0px 6px 14px 0px;background:rgb(255, 255, 255);margin-right:14px;position:relative;overflow:hidden;transition:transform 0.3s ease 0s, -webkit-transform 0.3s ease 0s;"><div><img src="BFPRT算法原理 - 知乎_files/v2-ad58d8d0a929f8233285fbb616fdbac0_qhd.jpg" type="image/jpeg" data-filename="v2-ad58d8d0a929f8233285fbb616fdbac0_qhd.jpg" height="123" style="height:123px;width:245px;object-fit:cover;border-top-left-radius:5px;border-top-right-radius:5px;" width="245"/><h1 style="font:inherit;font-weight:600;font-size:16px;min-width:225px;color:rgb(26, 26, 26);line-height:22px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-line-clamp:2;-webkit-box-orient:vertical;margin:12px;">数据结构和算法（三）：冒泡、选择、插入排序算法</h1><div style="position:absolute;bottom:12px;left:12px;display:flex;-webkit-box-pack:justify;justify-content:space-between;width:100%;font-size:14px;color:rgb(133, 144, 166);line-height:20px;"><span>张晓康</span><span style="margin-right:24px;"></span></div></div></a></ul></div><div style="overflow:hidden;width:690px;height:100%;border-top:52px solid transparent;margin:-52px auto 0px;"><div style="display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;height:100%;box-sizing:border-box;border:1px solid rgb(235, 235, 235);box-shadow:rgba(26, 26, 26, 0.1) 0px 1px 3px;background:rgb(255, 255, 255);margin-top:12px;border-radius:4px;overflow:visible;"><div style="background:rgb(255, 255, 255);border-bottom:1px solid rgb(246, 246, 246);display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center;height:50px;border-radius:2px;padding:0px;margin:0px 20px;"><div style="-webkit-box-flex:1;flex:1 1 0%;"><h2 style="margin:0px;font:inherit;display:inline-block;font-size:15px;font-weight:600;color:rgb(26, 26, 26);">8 条评论</h2></div><div></div></div><div><div style="position:relative;transition:padding-right 0.3s ease 0s;padding:12px 20px;background:rgb(255, 255, 255);border-top:none;"><div style="position:relative;display:flex;-webkit-box-align:end;align-items:flex-end;border:1px solid rgb(235, 235, 235);border-radius:3px;background-color:rgb(246, 246, 246);"><div style="background:rgb(255, 255, 255);border-radius:3px;box-sizing:border-box;transition:background 0.2s ease 0s, border 0.2s ease 0s;font-size:15px;border:none;padding:0px;overflow:hidden;width:100%;"><div style="word-break:break-word;line-height:1.6;min-height:198px;position:relative;padding:6px 12px;cursor:text;"><span style="line-height:1.6;cursor:text;clear:both;display:block;"></span><div style="margin-top:0px;margin-bottom:0px;"><div style="color:rgb(133, 144, 166);position:absolute;pointer-events:none;"><div style="white-space:pre-wrap;">写下你的评论...</div></div><div><div style="outline:none;user-select:text;white-space:pre-wrap;overflow-wrap:break-word;"><div><div style="margin-top:0px;margin-bottom:0px;margin:0px;"><div><span><br/></span></div></div></div></div></div></div><span style="line-height:1.6;cursor:text;clear:both;display:block;"></span></div><div></div></div><div style="height:36px;display:flex;-webkit-box-align:center;align-items:center;"><div style="display:flex;"><div style="position:relative;display:inline-block;width:24px;height:24px;margin-right:12px;"></div></div></div></div></div></div><div><div style="-webkit-box-flex:1;flex:1 1 0%;overflow:hidden auto;overflow-y:visible;"><ul style="padding:0px;margin:0px;position:relative;"><li style="list-style-type:none;"><div style="position:relative;flex-shrink:0;padding:12px 20px 10px;font-size:15px;outline:none;"><div><div style="position:relative;height:24px;padding-right:3px;padding-left:1px;margin-bottom:4px;line-height:24px;"><span style="margin-right:8px;"><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/michael-72-22" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank"><img src="BFPRT算法原理 - 知乎_files/eaf8ff837766db0f71bc72202cbaaf09_xs.jpg" type="image/jpeg" data-filename="eaf8ff837766db0f71bc72202cbaaf09_xs.jpg" height="24" style="background:rgb(255, 255, 255);border-radius:2px;vertical-align:top;" width="24"/></a></div></div></span><span><a href="https://www.zhihu.com/people/michael-72-22" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank">Michael</a></span><span style="float:right;font-size:14px;color:rgb(133, 144, 166);">2 年前</span></div><div style="padding-left:33px;"><div style="margin-bottom:6px;line-height:25px;"><div style="word-break:break-word;line-height:1.6;"><p style="margin:1.4em 0px;margin-top:0px;">&quot;如果选用3，有  ，其操作元素个数还是  。&quot;</p><p style="margin:-0.8em 0px;"><br/></p><p style="margin:1.4em 0px;">复杂度因该是 O(nlgn)</p><p style="margin:1.4em 0px;margin-bottom:0px;"></p></div></div><div style="display:flex;-webkit-box-align:center;align-items:center;height:24px;font-size:14px;line-height:24px;margin-top:4px;"></div></div></div></div></li><span style="position:absolute;left:0px;right:0px;bottom:0px;display:block;margin:0px 20px;border-bottom:1px solid rgb(246, 246, 246);"></span></ul><ul style="padding:0px;margin:0px;position:relative;"><li style="list-style-type:none;"><div style="position:relative;flex-shrink:0;padding:12px 20px 10px;font-size:15px;outline:none;"><div><div style="position:relative;height:24px;padding-right:3px;padding-left:1px;margin-bottom:4px;line-height:24px;"><span style="margin-right:8px;"><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/spark-90" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank"><img src="BFPRT算法原理 - 知乎_files/v2-95e42b25fa8cd881cd13146fba40a2d4_xs.jpg" type="image/jpeg" data-filename="v2-95e42b25fa8cd881cd13146fba40a2d4_xs.jpg" height="24" style="background:rgb(255, 255, 255);border-radius:2px;vertical-align:top;" width="24"/></a></div></div></span><span><a href="https://www.zhihu.com/people/spark-90" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank">spark</a></span><span style="float:right;font-size:14px;color:rgb(133, 144, 166);">9 个月前</span></div><div style="padding-left:33px;"><div style="margin-bottom:6px;line-height:25px;"><div style="word-break:break-word;line-height:1.6;"><p style="margin:1.4em 0px;margin-top:0px;margin-bottom:0px;">面试的时候经常问topK问题，能答出来BRPRT算法的面试者就给人印象很深刻</p></div></div><div style="display:flex;-webkit-box-align:center;align-items:center;height:24px;font-size:14px;line-height:24px;margin-top:4px;"></div></div></div></div></li><span style="position:absolute;left:0px;right:0px;bottom:0px;display:block;margin:0px 20px;border-bottom:1px solid rgb(246, 246, 246);"></span></ul><ul style="padding:0px;margin:0px;position:relative;"><li style="list-style-type:none;"><div style="position:relative;flex-shrink:0;padding:12px 20px 10px;font-size:15px;outline:none;"><div><div style="position:relative;height:24px;padding-right:3px;padding-left:1px;margin-bottom:4px;line-height:24px;"><span style="margin-right:8px;"><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/dahaiyidi" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank"><img src="BFPRT算法原理 - 知乎_files/dfd6f4ca4fd059f1de3cdb3b18d9b375_xs.jpg" type="image/jpeg" data-filename="dfd6f4ca4fd059f1de3cdb3b18d9b375_xs.jpg" height="24" style="background:rgb(255, 255, 255);border-radius:2px;vertical-align:top;" width="24"/></a></div></div></span><span><a href="https://www.zhihu.com/people/dahaiyidi" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank">Dahaiyidi</a></span><span style="float:right;font-size:14px;color:rgb(133, 144, 166);">5 个月前</span></div><div style="padding-left:33px;"><div style="margin-bottom:6px;line-height:25px;"><div style="word-break:break-word;line-height:1.6;"><p style="margin:1.4em 0px;margin-top:0px;margin-bottom:0px;">请问return FindMid(a, l, l + n);是否最好调用BFPR，以避免中位数过多？</p></div></div><div style="display:flex;-webkit-box-align:center;align-items:center;height:24px;font-size:14px;line-height:24px;margin-top:4px;"></div></div></div></div></li><span style="position:absolute;left:0px;right:0px;bottom:0px;display:block;margin:0px 20px;border-bottom:1px solid rgb(246, 246, 246);"></span></ul><ul style="padding:0px;margin:0px;position:relative;"><li style="list-style-type:none;"><div style="position:relative;flex-shrink:0;padding:12px 20px 10px;font-size:15px;outline:none;"><div><div style="position:relative;height:24px;padding-right:3px;padding-left:1px;margin-bottom:4px;line-height:24px;"><span style="margin-right:8px;"><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/zhu-chong-71" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank"><img src="BFPRT算法原理 - 知乎_files/fa4eef28c_xs.jpg" type="image/jpeg" data-filename="fa4eef28c_xs.jpg" height="24" style="background:rgb(255, 255, 255);border-radius:2px;vertical-align:top;" width="24"/></a></div></div></span><span><a href="https://www.zhihu.com/people/zhu-chong-71" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank">朱翀</a></span><span style="float:right;font-size:14px;color:rgb(133, 144, 166);">5 个月前</span></div><div style="padding-left:33px;"><div style="margin-bottom:6px;line-height:25px;"><div style="word-break:break-word;line-height:1.6;"><p style="margin:1.4em 0px;margin-top:0px;margin-bottom:0px;">感觉时间复杂证明这里有些不严谨，T(N)的设定假设了FINDMID以及BRPRT函数的时间复杂度函数关系相同</p></div></div><div style="display:flex;-webkit-box-align:center;align-items:center;height:24px;font-size:14px;line-height:24px;margin-top:4px;"></div></div></div></div></li><span style="position:absolute;left:0px;right:0px;bottom:0px;display:block;margin:0px 20px;border-bottom:1px solid rgb(246, 246, 246);"></span></ul><ul style="padding:0px;margin:0px;position:relative;"><li style="list-style-type:none;"><div style="position:relative;flex-shrink:0;padding:12px 20px 10px;font-size:15px;outline:none;"><div><div style="position:relative;height:24px;padding-right:3px;padding-left:1px;margin-bottom:4px;line-height:24px;"><span style="margin-right:8px;"><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/jiang-zhi-qiang-56-80" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank"><img src="BFPRT算法原理 - 知乎_files/v2-9b718289feb17c397cff909d5722e8bc_xs.jpg" type="image/jpeg" data-filename="v2-9b718289feb17c397cff909d5722e8bc_xs.jpg" height="24" style="background:rgb(255, 255, 255);border-radius:2px;vertical-align:top;" width="24"/></a></div></div></span><span><a href="https://www.zhihu.com/people/jiang-zhi-qiang-56-80" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank">夜是故乡明</a></span><span style="float:right;font-size:14px;color:rgb(133, 144, 166);">5 个月前</span></div><div style="padding-left:33px;"><div style="margin-bottom:6px;line-height:25px;"><div style="word-break:break-word;line-height:1.6;"><p style="margin:1.4em 0px;margin-top:0px;margin-bottom:0px;">快速排序一次划分应该是Partition</p></div></div><div style="display:flex;-webkit-box-align:center;align-items:center;height:24px;font-size:14px;line-height:24px;margin-top:4px;"></div></div></div></div></li><span style="position:absolute;left:0px;right:0px;bottom:0px;display:block;margin:0px 20px;border-bottom:1px solid rgb(246, 246, 246);"></span></ul><ul style="padding:0px;margin:0px;position:relative;"><li style="list-style-type:none;"><div style="position:relative;flex-shrink:0;padding:12px 20px 10px;font-size:15px;outline:none;"><div><div style="position:relative;height:24px;padding-right:3px;padding-left:1px;margin-bottom:4px;line-height:24px;"><span style="margin-right:8px;"><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/li-qiao-70-93" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank"><img src="BFPRT算法原理 - 知乎_files/v2-dfb00c690dfb63a20454307d9cc3badc_xs.jpg" type="image/jpeg" data-filename="v2-dfb00c690dfb63a20454307d9cc3badc_xs.jpg" height="24" style="background:rgb(255, 255, 255);border-radius:2px;vertical-align:top;" width="24"/></a></div></div></span><span><a href="https://www.zhihu.com/people/li-qiao-70-93" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank">李桥</a></span><span style="float:right;font-size:14px;color:rgb(133, 144, 166);">4 个月前</span></div><div style="padding-left:33px;"><div style="margin-bottom:6px;line-height:25px;"><div style="word-break:break-word;line-height:1.6;"><p style="margin:1.4em 0px;margin-top:0px;margin-bottom:0px;">时间复杂度的证明是不是有问题？你直接预设了要证明的东西……</p></div></div><div style="display:flex;-webkit-box-align:center;align-items:center;height:24px;font-size:14px;line-height:24px;margin-top:4px;"></div></div></div></div></li><span style="position:absolute;left:0px;right:0px;bottom:0px;display:block;margin:0px 20px;border-bottom:1px solid rgb(246, 246, 246);"></span></ul><ul style="padding:0px;margin:0px;position:relative;"><li style="list-style-type:none;"><div style="position:relative;flex-shrink:0;padding:12px 20px 10px;font-size:15px;outline:none;"><div><div style="position:relative;height:24px;padding-right:3px;padding-left:1px;margin-bottom:4px;line-height:24px;"><span style="margin-right:8px;"><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/weilong-zhang-90" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank"><img src="BFPRT算法原理 - 知乎_files/fe2dc831c_xs.jpg" type="image/jpeg" data-filename="fe2dc831c_xs.jpg" height="24" style="background:rgb(255, 255, 255);border-radius:2px;vertical-align:top;" width="24"/></a></div></div></span><span><a href="https://www.zhihu.com/people/weilong-zhang-90" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank">Weilong Zhang</a></span><span style="float:right;font-size:14px;color:rgb(133, 144, 166);">1 个月前</span></div><div style="padding-left:33px;"><div style="margin-bottom:6px;line-height:25px;"><div style="word-break:break-word;line-height:1.6;"><p style="margin:1.4em 0px;margin-top:0px;">感觉最后一段写的有点模糊。</p><p style="margin:1.4em 0px;margin-bottom:0px;">如果选用3的话，复杂度是O(nlgn), 选择其他的奇数的话，复杂度都是O(N)。</p></div></div><div style="display:flex;-webkit-box-align:center;align-items:center;height:24px;font-size:14px;line-height:24px;margin-top:4px;"></div></div></div></div></li><span style="position:absolute;left:0px;right:0px;bottom:0px;display:block;margin:0px 20px;border-bottom:1px solid rgb(246, 246, 246);"></span></ul><ul style="padding:0px;margin:0px;position:relative;"><li style="list-style-type:none;"><div style="position:relative;flex-shrink:0;padding:12px 20px 10px;font-size:15px;outline:none;"><div><div style="position:relative;height:24px;padding-right:3px;padding-left:1px;margin-bottom:4px;line-height:24px;"><span style="margin-right:8px;"><div style="position:relative;display:inline-block;"><div><a href="https://www.zhihu.com/people/akax-93" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank"><img src="BFPRT算法原理 - 知乎_files/da8e974dc_xs.jpg" type="image/jpeg" data-filename="da8e974dc_xs.jpg" height="24" style="background:rgb(255, 255, 255);border-radius:2px;vertical-align:top;" width="24"/></a></div></div></span><span><a href="https://www.zhihu.com/people/akax-93" style="color:inherit;text-decoration:none;font-weight:500;" target="_blank">AKAX</a></span><span style="float:right;font-size:14px;color:rgb(133, 144, 166);">18 天前</span></div><div style="padding-left:33px;"><div style="margin-bottom:6px;line-height:25px;"><div style="word-break:break-word;line-height:1.6;"><p style="margin:1.4em 0px;margin-top:0px;margin-bottom:0px;">呵呵。。。先留名，我也许有更好的方法。</p></div></div><div style="display:flex;-webkit-box-align:center;align-items:center;height:24px;font-size:14px;line-height:24px;margin-top:4px;"></div></div></div></div></li></ul></div></div></div></div></div></div></span></div></div><div></div><div><div></div></div></div></div></div>
</div>
</span>
</div></body></html> 